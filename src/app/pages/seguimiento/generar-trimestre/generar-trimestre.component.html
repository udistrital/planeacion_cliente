<mat-card class="card-oas">
    <mat-card-header>
        <div style="text-align:center;">
            <mat-card-title>SEGUIMIENTO PLANES DE ACCIÓN</mat-card-title>
            <mat-card-subtitle>Unidad Académico y/o administrativa {{unidad}}</mat-card-subtitle>
            <br>
            <mat-card-subtitle class="subtitulo">
                A continuación encontrará un listado de las actividades asociadas al Plan de Acción, a las cuales podrá realizar la revisión para el periodo respectivo.
            </mat-card-subtitle>
        </div>
    </mat-card-header>
    <mat-card-content>
        <br>
        <form [formGroup]="formGenerarTrimestre">
            <div class="container-border">
                <h1 class="head-border">INFORMACIÓN DEL PLAN</h1>
                <mat-grid-list cols="6" rowHeight="35px" gutterSize="5px">
                    <mat-grid-tile class="titulo">Actividad general</mat-grid-tile>
                    <mat-grid-tile>
                        <textarea class="width-text-trimestre" [readonly]="true" placeholder="Actividad"></textarea>
                    </mat-grid-tile>
                    <mat-grid-tile class="titulo" colspan="4">Descripción de la actividad</mat-grid-tile>
                    <mat-grid-tile class="titulo">Ponderación</mat-grid-tile>
                    <mat-grid-tile>
                        <textarea class="width-text-trimestre" [readonly]="true" placeholder="%"></textarea>
                    </mat-grid-tile>
                    <mat-grid-tile colspan="4" rowspan="2">
                        <textarea class="width-text-trimestre" [readonly]="true" placeholder="Descripción de la actividad general seleccionada"></textarea>
                    </mat-grid-tile>
                    <mat-grid-tile class="titulo">Periodo de ejecución</mat-grid-tile>
                    <mat-grid-tile>
                        <textarea class="width-text-trimestre" [readonly]="true" placeholder="Periodo"></textarea>
                    </mat-grid-tile>
                </mat-grid-list>

                <mat-grid-list cols="6" rowHeight="35px" gutterSize="5px">
                    <mat-grid-tile colspan="2" class="titulo">Productos asociados</mat-grid-tile>
                    <mat-grid-tile class="titulo" colspan="4">Tareas asociadas</mat-grid-tile>
                    <mat-grid-tile colspan="2" rowspan="2">
                        <textarea class="width-text-trimestre" [readonly]="true"></textarea>
                    </mat-grid-tile>
                    <mat-grid-tile colspan="4" rowspan="2">
                        <textarea class="width-text-trimestre" [readonly]="true" placeholder="Tareas asociadas a la actividad general"></textarea>
                    </mat-grid-tile>
                </mat-grid-list>
                <div class="container-border">
                    <h1>COMPONENTE CUALITATIVO</h1>
                    <br>
                    <mat-card class="desc-input-label">
                        <mat-card-header>Reporte de avance del trimestre</mat-card-header>
                        <mat-card-content>
                            <textarea class="width-text-trimestre" id="reporte" placeholder="Reporte"
                            formControlName="reporte" required
                            [readonly]="!indicadorSelected || readonlyFormulario"></textarea>
                        </mat-card-content>
                    </mat-card>
                    <mat-card class="desc-input-label">
                        <mat-card-header>Productos intermedios</mat-card-header>
                        <mat-card-content>
                            <textarea class="width-text-trimestre" id="Producto" placeholder="Producto" formControlName="producto"
                            required [readonly]="!indicadorSelected || readonlyFormulario"></textarea>
                        </mat-card-content>
                    </mat-card>
                    <mat-card class="desc-input-label">
                        <mat-card-header>Evidencias</mat-card-header>
                        <mat-card-content>
                            <ng-container>
                                <mat-form-field appearance="fill" [style.width.%]="100" style="
                                        border: 2px solid var(--primary);
                                        border-radius: 7px;
                                        margin-top: 4px;
                                    ">
                                    <mat-label id="tipo-input-label">Seleccione el documento</mat-label>
                                    <mat-select formControlName="documentos" (selectionChange)="onChangeD($event.value)">
                                        <mat-option>--</mat-option>
                                        <mat-option *ngFor="let documento of documentos" [value]="documento">
                                            {{documento.name}}
                                        </mat-option>
                                    </mat-select>
                                </mat-form-field>
                            </ng-container>
                            <ng-container>
                                <ng-container *ngIf="documentoSeleccionado != undefined">
                                    <textarea class="width-text-documento" id="documento-seleccionado"
                                        placeholder="Documento Seleccionado" readonly>{{documentoSeleccionado.name}}
                                </textarea>
                                    <button class="icon-documento" mat-icon-button (click)="revisarDocumento('documento')">
                                        <mat-icon>search</mat-icon>
                                    </button>
                                    <button class="icon-documento" mat-icon-button (click)="eliminarDocumento()"
                                        [disabled]="readonlyFormulario" *ngIf="rol=='JEFE_DEPENDENCIA'">
                                        <mat-icon>delete_outline</mat-icon>
                                    </button>
                                </ng-container>
                                <mat-label *ngIf="rol=='JEFE_DEPENDENCIA'" class="width-label-upload">
                                    <input type="file" (change)="onChangeDocumento($event.target)"><br>
                                    Seleccione un archivo...
                                </mat-label>
                            </ng-container>
                        </mat-card-content>
                    </mat-card>
                    <mat-card class="desc-input-label">
                        <mat-card-header>Dificultades</mat-card-header>
                        <mat-card-content>
                            <textarea class="width-text-trimestre" id="Dificultades" placeholder="Dificultades"
                            formControlName="dificultades" required
                            [readonly]="!indicadorSelected || readonlyFormulario"></textarea>
                        </mat-card-content>
                    </mat-card>
                    <mat-card class="desc-input-label">
                        <mat-card-header>Observaciones</mat-card-header>
                        <mat-card-content>
                            <textarea class="width-text-trimestre" id="Observaciones" placeholder="Observaciones"
                            formControlName="observaciones" required
                            [readonly]="!indicadorSelected || readonlyFormulario"></textarea>
                        </mat-card-content>
                    </mat-card>
                    <button class="width-button-generate" mat-raised-button (click)="guardarDataIndicador()"
                        *ngIf="rol=='JEFE_DEPENDENCIA'" [disabled]="!formGenerarTrimestre.valid || readonlyFormulario">
                        Validar Indicador</button>
                </div>
                <br>
                <div class="container-border">
                    <h1>COMPONENTE CUANTITATIVO</h1>
                    <div class="tabla-indicadores mat-elevation-z8">
                        <div>
                            <table mat-table [dataSource]="datosIndicadores">

                                <ng-container matColumnDef="nombre">
                                  <th mat-header-cell *matHeaderCellDef> Nombre </th>
                                  <td mat-cell *matCellDef="let element"> {{element.nombre}} </td>
                                </ng-container>
      
                                <ng-container matColumnDef="formula">
                                  <th mat-header-cell *matHeaderCellDef> Formula </th>
                                  <td mat-cell *matCellDef="let element"> {{element.formula}} </td>
                                </ng-container>
      
                                <ng-container matColumnDef="meta">
                                  <th mat-header-cell *matHeaderCellDef> Meta </th>
                                  <td mat-cell *matCellDef="let element"> {{element.meta}} </td>
                                </ng-container>
                          
                                <ng-container matColumnDef="header-row-general">
                                  <th mat-header-cell *matHeaderCellDef 
                                      [style.text-align]="center"
                                      [attr.colspan]="3"> 
                                    Indicadores asociados a la actividad general
                                  </th>
                                </ng-container>
                          
                                <ng-container matColumnDef="header-row-nombre">
                                  <th mat-header-cell *matHeaderCellDef 
                                      [style.text-align]="center"
                                      class="secundaria"> 
                                    Nombre 
                                  </th>
                                </ng-container>
                                
                                <ng-container matColumnDef="header-row-formula">
                                  <th mat-header-cell *matHeaderCellDef 
                                      [style.text-align]="center"
                                      class="secundaria"> 
                                    Formula 
                                  </th>
                                </ng-container>
                                
                                <ng-container matColumnDef="header-row-meta">
                                  <th mat-header-cell *matHeaderCellDef 
                                      [style.text-align]="center"
                                      class="secundaria"> 
                                    Meta
                                  </th>
                                </ng-container>

                                <tr mat-header-row *matHeaderRowDef="['header-row-general']"></tr>
                                <tr mat-header-row *matHeaderRowDef="['header-row-nombre', 'header-row-formula','header-row-meta']"></tr>
                                <tr mat-row *matRowDef="let row; columns: ['nombre','formula','meta'];"></tr>

                            </table>
                        </div>
                        <div>
                            <table mat-table [dataSource]="datosIndicadores">
                          
                                <ng-container matColumnDef="reporteNumerador">
                                    <th mat-header-cell *matHeaderCellDef> Reporte numerador </th>
                                    <td mat-cell *matCellDef="let element"> {{element.reporteNumerador}} </td>
                                </ng-container>
                                
                                <ng-container matColumnDef="reporteDenominador">
                                    <th mat-header-cell *matHeaderCellDef> Reporte denominador </th>
                                    <td mat-cell *matCellDef="let element"> {{element.reporteDenominador}} </td>
                                </ng-container>
                                
                                <ng-container matColumnDef="detalleReporte">
                                    <th mat-header-cell *matHeaderCellDef> Detalle del reporte </th>
                                    <td mat-cell *matCellDef="let element"> {{element.detalleReporte}} </td>
                                </ng-container>
                          
                                <ng-container matColumnDef="header-row-general">
                                  <th mat-header-cell *matHeaderCellDef 
                                      [style.text-align]="center"
                                      [attr.colspan]="3"> 
                                    Indicadores asociados a la actividad general
                                  </th>
                                </ng-container>
                          
                                <ng-container matColumnDef="header-row-numerador">
                                  <th mat-header-cell *matHeaderCellDef 
                                      [style.text-align]="center"
                                      class="secundaria"> 
                                    Numerador
                                  </th>
                                </ng-container>
                                
                                <ng-container matColumnDef="header-row-denominador">
                                  <th mat-header-cell *matHeaderCellDef 
                                      [style.text-align]="center"
                                      class="secundaria"> 
                                    Denominador 
                                  </th>
                                </ng-container>
                                
                                <ng-container matColumnDef="header-row-detalle">
                                  <th mat-header-cell *matHeaderCellDef 
                                      [style.text-align]="center"
                                      class="secundaria"> 
                                    Detalle del reporte
                                  </th>
                                </ng-container>

                                <tr mat-header-row *matHeaderRowDef="['header-row-general']"></tr>
                                <tr mat-header-row *matHeaderRowDef="['header-row-numerador', 'header-row-denominador','header-row-detalle']"></tr>
                                <tr mat-row *matRowDef="let row; columns: ['reporteNumerador','reporteDenominador','detalleReporte'];"></tr>

                            </table>
                        </div>
                        <div>
                            <table mat-table [dataSource]="datosIndicadores" style="margin-top: 4em;">
                          
                                <ng-container matColumnDef="observaciones">
                                  <th mat-header-cell *matHeaderCellDef> Oservaciones Oficina Asesora de Planeación y Control </th>
                                  <td mat-cell *matCellDef="let element"> {{element.observaciones}} </td>
                                </ng-container>
                          
                                <ng-container matColumnDef="header-row-general">
                                  <th mat-header-cell *matHeaderCellDef 
                                      [style.text-align]="center"> 
                                    Observaciones Oficina Asesora de Planeación y Control
                                  </th>
                                </ng-container>

                                <tr mat-header-row *matHeaderRowDef="['header-row-general']"></tr>
                                <tr mat-row *matRowDef="let row; columns: ['observaciones'];"></tr>

                            </table>
                        </div>
                      </div>
                      <br>

                      <hr>
                      
                      <br>
                      <div class="mat-elevation-z8">
                        <table mat-table  [dataSource]="datosResultados">
                      
                          <ng-container matColumnDef="indicador">
                            <th mat-header-cell *matHeaderCellDef class="secundaria"> Indicador del periodo </th>
                            <th mat-header-cell *matHeaderCellDef class="descripcion"> A partir del reporte de las variables para el periodo se calcula el reporte del trimestre </th>
                            <td mat-cell *matCellDef="let element"> {{element.indicador}} </td>
                          </ng-container>
                      
                          <ng-container matColumnDef="indicadorAcumulado">
                            <th mat-header-cell *matHeaderCellDef class="secundaria"> Indicador acumulado </th>
                            <th mat-header-cell *matHeaderCellDef class="descripcion"> Consolida el valor del indicador hasta el ultimo periodo reportado </th>
                            <td mat-cell *matCellDef="let element"> {{element.indicadorAcumulado}} </td>
                          </ng-container>
                      
                          <ng-container matColumnDef="avanceAcumulado">
                            <th mat-header-cell *matHeaderCellDef class="secundaria"> Avance acumulado </th>
                            <th mat-header-cell *matHeaderCellDef class="descripcion"> Contrasta el reporte el indicador acumulado con la meta de la vigencia </th>
                            <td mat-cell *matCellDef="let element"> {{element.avanceAcumulado}} </td>
                          </ng-container>
                          
                          <ng-container matColumnDef="brechaExistente" class="secundaria">
                            <th mat-header-cell *matHeaderCellDef class="secundaria"> Brecha existente </th>
                            <th mat-header-cell *matHeaderCellDef class="descripcion"> A partir de la meta establecida y el cálculo del indicador acumulado establece la brecha existente o el faltante por cubrir </th>
                            <td mat-cell *matCellDef="let element"> {{element.brechaExistente}} </td>
                          </ng-container>
                          
                          <ng-container matColumnDef="header-row-general">
                            <th mat-header-cell *matHeaderCellDef 
                                [style.text-align]="center"
                                [attr.colspan]="4"> 
                              Resultados asociados al reporte del indicador
                            </th>
                          </ng-container>

                          <ng-container matColumnDef="header-row-ind">
                            <th mat-header-cell *matHeaderCellDef 
                                [style.text-align]="center"
                                class="descripcion"> 
                                A partir del reporte de las variables para el periodo se calcula el reporte del trimestre
                            </th>
                          </ng-container>

                          <ng-container matColumnDef="header-row-acumulado">
                            <th mat-header-cell *matHeaderCellDef 
                                [style.text-align]="center"
                                class="descripcion"> 
                                Consolida el valor del indicador hasta el ultimo periodo reportado
                            </th>
                          </ng-container>

                          <ng-container matColumnDef="header-row-avanceAcumulado">
                            <th mat-header-cell *matHeaderCellDef 
                                [style.text-align]="center"
                                class="descripcion"> 
                                Contrasta el reporte el indicador acumulado con la meta de la vigencia
                            </th>
                          </ng-container>

                          <ng-container matColumnDef="header-row-brecha">
                            <th mat-header-cell *matHeaderCellDef 
                                [style.text-align]="center"
                                class="descripcion"> 
                                A partir de la meta establecida y el cálculo del indicador acumulado establece la brecha existente o el faltante por cubrir
                            </th>
                          </ng-container>


                          
                          <tr mat-header-row *matHeaderRowDef="['header-row-general']"></tr>
                          <tr mat-header-row *matHeaderRowDef="['indicador','indicadorAcumulado', 'avanceAcumulado', 'brechaExistente']"></tr>
                          <tr mat-header-row *matHeaderRowDef="['header-row-ind','header-row-acumulado', 'header-row-avanceAcumulado','header-row-brecha']"></tr>
                          <tr mat-row *matRowDef="let row; columns: ['indicador','indicadorAcumulado', 'avanceAcumulado', 'brechaExistente'];"></tr>
                        </table>
                      </div>
                </div>

            </div>
            <br>
            <div class="container-border" *ngIf="mostrarObservaciones">
                <h1>Observaciones planeacion</h1>
                <br>
                <div class="container-border-comentarios">
                    <h1>Comentarios</h1>
                    <textarea class="width-text-trimestre boder-text" id="Observaciones"
                        formControlName="observacionesP" placeholder="Comentarios"
                        [readonly]="readonlyObservacion || !indicadorSelected" (change)="getDataUser()"></textarea>
                    <ng-container *ngIf="documentoPlaneacion != undefined">
                        <textarea class="width-text-documento" id="documento-planeacion"
                            placeholder="Documento Seleccionado" readonly>{{documentoPlaneacion.name}}
                            </textarea>
                        <button class="icon-documento" mat-icon-button (click)="revisarDocumento()">
                            <mat-icon>search</mat-icon>
                        </button>
                        <button class="icon-documento" mat-icon-button *ngIf="rol=='PLANEACION'"
                            (click)="eliminarDocumentoP('documentoP')">
                            <mat-icon>delete_outline</mat-icon>
                        </button>
                    </ng-container>
                    <label *ngIf="rol=='PLANEACION'" class="width-label-upload">
                        <input type="file" (change)="onChangeDocumentoP($event.target)"
                            [disabled]="!indicadorSelected"><br>
                        Seleccione un archivo...
                    </label>
                </div>
                <br>
                <mat-label class="margin-label" id="desc-input-label">Quien da la respueta: </mat-label>
                <input class="input-autor" type="text" matInput formControlName="autor" readonly>
                <!-- <mat-label class="margin-label" id="desc-input-label">Rol: </mat-label>
                <input class="plan-generar" type="text" matInput  required> -->
                <br>
                <div *ngIf="rol=='PLANEACION'" class="align-button-enviar">
                    <button class="width-button-generate" (click)="guardarDataIndicador()" mat-raised-button
                        color="primary" [disabled]="!indicadorSelected">Validar Indicador</button>
                </div>
            </div>
            <div class="container-button">
                <button class="background-button align-button1" mat-raised-button color="primary"
                    [disabled]="!formGenerarTrimestre.valid" (click)="guardarSeguimiento()">Guardar</button>
                <button class="background-button align-button2" mat-raised-button color="primary"
                    (click)="backClicked()">Regresar</button>
            </div>
            <div class="align-button-enviar" *ngIf="rol=='JEFE_DEPENDENCIA' && estadoSeguimiento==='En Reporte'">
                <button class="background-button" mat-raised-button color="primary" (click)="generarReporte()">Generar
                    Reporte</button>
            </div>
            <div class="align-button-enviar"
                *ngIf="rol=='PLANEACION' && (estadoSeguimiento==='Generado' || estadoSeguimiento==='Ajustado')">
                <button class="background-button" mat-raised-button color="primary" (click)="enviarObservacion()">Enviar
                    Observación</button>
            </div>
            <div class="align-button-enviar"
                *ngIf="rol=='PLANEACION' && (estadoSeguimiento==='Generado' ||estadoSeguimiento==='Ajustado')">
                <button class="background-button" mat-raised-button color="primary" (click)="aprobarReporte()">Aprobar
                    Reporte</button>
            </div>
            <div class="align-button-enviar" *ngIf="rol=='JEFE_DEPENDENCIA' && estadoSeguimiento==='Observación'">
                <button class="background-button" mat-raised-button color="primary" (click)="ajustarReporte()">Reenviar
                    Reporte</button>
            </div>
        </form>
    </mat-card-content>
</mat-card>