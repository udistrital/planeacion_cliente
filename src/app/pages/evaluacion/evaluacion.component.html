<mat-card class="card-oas">
  <mat-card-header>
    <mat-card-title>Evaluación planes de acción anuales</mat-card-title>
  </mat-card-header>
  <mat-card-content>
    <ng-container>
      <div>
        <div>
          <u class="textGuide">
            A continuación encontrará un listado de unidades y vigencia, usted debe realizar la selección en cada una de
            las listas correspondientes.
          </u>
          <br>
        </div>
      </div>
    </ng-container>
    <mat-form-field class="selectorPlanStyle" appearance="fill">
      <mat-label id="tipo-input-label">Seleccionar Unidad</mat-label>
      <mat-select id="test" (selectionChange)="onChangeU($event.value)">
        <mat-option>--</mat-option>
        <mat-option *ngFor="let unidad of unidades" [value]="unidad">
          {{unidad.Nombre}}
        </mat-option>
      </mat-select>
    </mat-form-field>
    <mat-form-field class="selectorVigenciaStyle" appearance="fill">
      <mat-label id="tipo-input-label">Vigencia</mat-label>
      <mat-select (selectionChange)="onChangeV($event.value)">
        <mat-option>--</mat-option>
        <mat-option *ngFor="let vigencia of vigencias" [value]="vigencia">
          {{vigencia.Nombre}}
        </mat-option>
      </mat-select>
    </mat-form-field>

    <div class="align-button-ingresar">
      <button *ngIf="unidadSelected != false && vigenciaSelected != false" (click)="ingresarEvaluacion()"
        class="btn-gestion-seg" mat-raised-button color="primary">Consultar Evaluación</button>
    </div>
    <br>
    <div>
      <!-- <div *ngIf="bandera === true"> -->

      <div style="display: flex; justify-content: space-between; align-items: center;">
        <google-chart [title]="title" [type]="type" style="width: 30%;" height="400" [data]="pieChartData"
          [columns]="pieChartColumns" [options]="options"></google-chart>

        <google-chart [type]="type2" [data]="lineChartdata" style="width: 70%;" dynamicResize="true" height="400"
          [columns]="lineChartcolumnNames" [options]="lineChartoptions"></google-chart>
      </div>

      <br>
      <mat-card-header>
        <mat-card-title>Evaluación planes de acción anuales</mat-card-title>
      </mat-card-header>
      <!-- <table mat-table [dataSource]="dataSources" class="mat-elevation-z8">

        <ng-container matColumnDef="priority">
          <th mat-header-cell *matHeaderCellDef> Priority </th>
          <td mat-cell *matCellDef="let data; let i = index" 
              [attr.rowspan]="getRowSpan('priority', i)"
              [style.display]="getRowSpan('priority', i) ? '' : 'none'"> {{data.priority}} </td>
        </ng-container>
      
        <ng-container matColumnDef="status">
          <th mat-header-cell *matHeaderCellDef> Status </th>
          <td mat-cell *matCellDef="let data; let i = index" 
              [attr.rowspan]="getRowSpan('status', i)"
              [style.display]="getRowSpan('status', i) ? '' : 'none'"> {{data.status}} </td>
        </ng-container>
      
        <ng-container matColumnDef="dateCreated">
          <th mat-header-cell *matHeaderCellDef> Date created </th>
          <td mat-cell *matCellDef="let data; let i = index" 
              [attr.rowspan]="getRowSpan('dateCreated', i)"
              [style.display]="getRowSpan('dateCreated', i) ? '' : 'none'"> {{data.dateCreated}} </td>
        </ng-container>
      
        <ng-container matColumnDef="testNumber">
          <th mat-header-cell *matHeaderCellDef> test number </th>
          <td mat-cell *matCellDef="let data"> {{data.testNumber}} </td>
        </ng-container>
      
        <ng-container matColumnDef="testCurrency">
          <th mat-header-cell *matHeaderCellDef> test currency </th>
          <td mat-cell *matCellDef="let data"> {{data.testCurrency | currency}} </td>
        </ng-container>
      
        <ng-container matColumnDef="testTime">
          <th mat-header-cell *matHeaderCellDef> test time </th>
          <td mat-cell *matCellDef="let data"> {{data.testTime}} </td>
        </ng-container>
      
        <tr mat-header-row *matHeaderRowDef="displayedColumnss"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumnss;"></tr>
      </table> -->
      <br>

      <table mat-table [dataSource]="testDatos" matSort>
        <ng-container matColumnDef="id">
          <th mat-header-cell *matHeaderCellDef mat-sort-header> N° </th>
          <tr>
            <td [attr.rowspan]="row.indicador.length + 1" mat-cell *matCellDef="let row">{{row.numero}}</td>
          </tr>
        </ng-container>
        <ng-container matColumnDef="ponderacion">
          <th mat-header-cell *matHeaderCellDef mat-sort-header> Pond. </th>
          <tr>
            <td [attr.rowspan]="row.indicador.length + 1" mat-cell *matCellDef="let row"> {{row.ponderado}} </td>
          </tr>
        </ng-container>
        <ng-container matColumnDef="periodoE">
          <th mat-header-cell *matHeaderCellDef mat-sort-header> Periodo de ejecución </th>
          <tr>
            <td [attr.rowspan]="row.indicador.length + 1" mat-cell *matCellDef="let row"> {{row.periodo}} </td>
          </tr>
        </ng-container>
        <ng-container matColumnDef="actividad">
          <th mat-header-cell *matHeaderCellDef mat-sort-header> Actividad general </th>
          <tr>
            <td [attr.rowspan]="row.indicador.length + 1" mat-cell *matCellDef="let row"> {{row.actividad}} </td>
          </tr>
        </ng-container>

        <ng-container matColumnDef="indicador">
          <th mat-header-cell *matHeaderCellDef mat-sort-header> Indicador asociado </th>
          <!-- <tr *ngFor="let item in row.indicador"> -->
          <td mat-cell *matCellDef="let row; let rowIndex = index;"> {{row.indicador[0].indicadorN}}</td>
          <!-- </tr> -->
        </ng-container>
        <ng-container matColumnDef="formula">
          <th mat-header-cell *matHeaderCellDef mat-sort-header> Fórmula del indicador </th>
          <td mat-cell *matCellDef="let row; let rowIndex = index"> {{row.indicador[0].formula}} </td>
        </ng-container>
        <ng-container matColumnDef="meta">
          <th mat-header-cell *matHeaderCellDef mat-sort-header> Meta </th>
          <td mat-cell *matCellDef="let row"> {{row.indicador[0].meta}}
          </td>
        </ng-container>
        <ng-container matColumnDef="estado">
          <th mat-header-cell *matHeaderCellDef mat-sort-header> Trimestre 1 </th>
          <td mat-cell *matCellDef="let row"> {{row.trimestre1}}% </td>
        </ng-container>
        <ng-container matColumnDef="vigencia">
          <th mat-header-cell *matHeaderCellDef mat-sort-header> Trimestre 2 </th>
          <td mat-cell *matCellDef="let row">
            {{row.trimestre2}}%
          </td>
        </ng-container>
        <ng-container matColumnDef="periodo">
          <th mat-header-cell *matHeaderCellDef mat-sort-header> Trimestre 3 </th>
          <td mat-cell *matCellDef="let row">
            {{row.trimestre3}}%
          </td>
        </ng-container>
        <ng-container matColumnDef="seguimiento">
          <th mat-header-cell *matHeaderCellDef mat-sort-header> Trimestre 4 </th>
          <td mat-cell *matCellDef="let row">
            {{row.trimestre4}}%
          </td>
        </ng-container>
        <div>
          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
        </div>
        <tr class="mat-row" *matNoDataRow>
          <td class="mat-cell" colspan="4"></td>
        </tr>
      </table>
      <br>
      <div class="align-button-ingresar">
        <button class="btn-gestion-seg" mat-raised-button color="primary" (click)="backClicked()">Regresar</button>
      </div>
    </div>
  </mat-card-content>
</mat-card>